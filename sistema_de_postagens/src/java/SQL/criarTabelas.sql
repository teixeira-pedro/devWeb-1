/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 * Author:  pedroteixeira
 * Created: 13/06/2019
 */


CREATE TABLE "COMMENT" (
    "ID_C" INTEGER NOT NULL PRIMARY KEY GENERATED ALWAYS AS IDENTITY
        (START WITH 1, INCREMENT BY 1),
    "TEXT" VARCHAR(8000),
    "NICKNAME" VARCHAR(200) NOT NULL,
    "POST" INTEGER NOT NULL
);

CREATE TABLE "USR" (
    "NICKNAME" VARCHAR(200) NOT NULL PRIMARY KEY,
    "PASSWORD" VARCHAR(40) NOT NULL,
    "AVATAR" VARCHAR(8000) DEFAULT 'https://zcoin.io/wp-content/uploads/2017/01/blank-avatar-e1484377033610.png',
    "NAME" VARCHAR(200) NOT NULL
);

CREATE TABLE "POST" (
    "ID" INTEGER NOT NULL PRIMARY KEY GENERATED ALWAYS AS IDENTITY
        (START WITH 1, INCREMENT BY 1),
    "TITLE" VARCHAR(20),
    "TEXT" VARCHAR(8000),
    "AUTHOR"  VARCHAR(200) NOT NULL
);


ALTER TABLE "POST" ADD FOREIGN KEY ("AUTHOR") REFERENCES "USR" ;



ALTER TABLE "COMMENT" ADD FOREIGN KEY ("POST") REFERENCES "POST" ;

ALTER TABLE "COMMENT" ADD FOREIGN KEY ("NICKNAME") REFERENCES "USR" ;


/*CREATE TABLE Post(
    id          INTEGER             NOT NULL AUTO_INCREMENT,
    title       CHARACTER VARYING   ,
    text        CHARACTER VARYING   ,
    autor       CHARACTER VARYING   ,
    PRIMARY KEY(id),
    FOREIGN KEY autor REFERENCES Usr(nickname) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE Comment(
    id_c        INTEGER             NOT NULL AUTO_INCREMENT,
    title       CHARACTER VARYING   ,
    autor       CHARACTER VARYING   ,
    id_p        INTEGER             NOT NULL,
    FOREIGN KEY id_p REFERENCES Post(id) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY autor REFERENCES Usr(nickname) ON UPDATE CASCADE ON DELETE CASCADE,
    PRIMARY KEY(id_c)
);

CREATE TABLE Usr(
    nickname    CHARACTER VARYING   NOT NULL,
    senha       CHARACTER VARYING   NOT NULL,
    nome        CHARACTER VARYING,
    PRIMARY KEY(login)
);
*/